<th mat-header-cell>
  <div class="header-filter-container">
    <span
      *ngIf="hasSorting"
      mat-sort-header
      [sortActionDescription]="sortActionDescription"
      >{{ headerText }}</span
    >
    <span *ngIf="!hasSorting">{{ headerText }}</span>
    <ng-container
      *ngTemplateOutlet="
        filterButton;
        context: {
          name: filterName,
          title: filterTitle,
          filterOpened: filterOpened,
          activeFilter: activeFilter,
        }
      ">
    </ng-container>
  </div>
</th>

<ng-template
  #filterButton
  let-name="name"
  let-title="title"
  let-filterOpened="filterOpened"
  let-activeFilter="activeFilter">
  <button
    (click)="openFilter($event, name, title, filterOpened)"
    (keydown.enter)="openFilter($event, name, title, filterOpened)"
    (keydown.space)="openFilter($event, name, title, filterOpened)"
    class="filter-button filter-button-{{ name }}"
    [ngClass]="
      (filterOpened && activeFilter === name) || filtered ? 'active' : ''
    "
    attr.aria-label="filter by {{ name }}">
    <mat-icon fontSet="material-icons-outlined" class="filter-icon"
      >filter_list</mat-icon
    >
  </button>
</ng-template>
