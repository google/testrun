
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Testrun Report</title>
  <style>{{ styles }}</style>
</head>
  
<body>
  {% set page_index = namespace(value=0) %}
  {# Test Results #}
  {% for page in range(pages_num) %}
  {% set page_index.value = page_index.value+1 %}
  <div class="page">
    {% if loop.first %}
    <div class="header">
      <h1>Testrun report</h1>
      <h2 style="top: 50%;max-width:700px">
        {{ device['manufacturer'] }}
        {{ device['model']}}
      </h2>
    {% else %}
    <div class="header" style="margin-bottom:1px solid #DADCE0">
      <h1>Testrun report</h1>
      <h3 style="margin-top:0;max-width:700px"> 
        {{ device['manufacturer'] }}
        {{ device['model']}}
      </h3>
    {% endif %}   
      <img src="data:image/png;base64, {{ logo }}" alt="Testrun" width="90" style="position: absolute;top: 40%; right: 0px;"></img>
    </div>
    {% if loop.first %}
    <div class="summary-content">
      <div class="device-information">
        <div style="padding-right:0.1in;">
          <div class="summary-item-label"><h4>Manufacturer</h4></div>
          <div class="summary-item-value">{{ device['manufacturer']}}</div>
          <div class="summary-item-space"></div>
          <div class="summary-item-label"><h4>Model</h4></div>
          <div class="summary-item-value">{{ device['model'] }}</div>
          <div class="summary-item-space"></div>
          <div class="summary-item-label"><h4>Firmware</h4></div>
          <div class="summary-item-value">{{ device['firmware']}}</div>
          <div class="summary-item-space"></div>
          <div class="summary-item-label"><h4>MAC Address</h4></div>
          <div class="summary-item-value">{{ device['mac_addr'] }}</div>
        </div>
      </div>
        <div class="summary-device-modules">
          <div class="summary-item-label" style="margin-bottom:10px;">
            <h4>Device Configuration</h4>
          </div>
          {% for module, enabled in modules.items() %}
          <div class="summary-device-module-label">
            {% if enabled %}
            <span style="color:#34a853">✔ </span>
            {% else %}
            <span style="color:#ea4335">✖ </span>
            {% endif %}
            {{ module }}
          </div>
          {% endfor %}
        </div>
        {% if test_status == 'Compliant' %}
        <div class ="summary-color-box summary-box-compliant">
        {% else %}
        <div class ="summary-color-box summary-box-non-compliant">
        {% endif %}
          <div class="summary-box-label">Test Status</div>
          <div class="summary-box-value">Complete</div>
          <div class="summary-box-label">Test Result</div>
          <div style="color: white; font-size:24px; font-weight: 700;" class="summary-box-value">{{ test_status }}</div>
          <div class="summary-box-label">Started</div>
          <div class="summary-box-value">{{ json_data['started']}}</div>
          <div class="summary-box-label">Duration</div>
          <div class="summary-box-value">{{ duration }}</div>
      </div>
    </div>
    {% endif %}
      {% if loop.first %}
        {% set results_from = 0 %}
        {% set results_to = [tests_first_page, test_results|length]|min %}
      {% else %}
        {% set results_from = tests_first_page + (loop.index0 - 1) * tests_per_page %}
        {% set results_to = [results_from + tests_per_page, test_results|length]|min %}
      {% endif %}
      <div class="result-list">
        <h3>Results List <small>({{ successful_tests }}/{{ total_tests }})</small></h3>
        <div class="result-line" style="margin-top: 10px;border-top-left-radius:4px;border-top-right-radius:4px;">
          <div class="result-list-header-label" style="left: .1in">Name</div>
          <div class="result-list-header-label" style="left: 2.8in">Description</div>
          <div class="result-list-header-label" style="left: 7.3in">Result</div>
        </div>
        {% for i in range(results_from, results_to) %}
        <div class="result-line result-line-result">
          <div class="result-test-label" style="left: .1in;">{{ test_results[i]['name'] }}</div>
          <div class="result-test-label result-test-description" style="left: 2.8in;">{{ test_results[i]['description'] }}</div>
          {% if test_results[i]['result'] == 'Non-Compliant' %}
            <div class="result-test-label result-test-result result-test-result-non-compliant">
          {% elif test_results[i]['result'] == 'Compliant' %}
            <div class="result-test-label result-test-result result-test-result-compliant">
          {% elif  test_results[i]['result'] == 'Error' %}
            <div class="result-test-label result-test-result result-test-result-error">
          {% elif test_results[i]['result'] == 'Feature Not Detected' %}
            <div class="result-test-label result-test-result result-test-result-feature-not-detected">
          {% elif test_results[i]['result'] == 'Informational' %}
            <div class="result-test-label result-test-result result-test-result-informational">
          {% else %}
            <div class="result-test-label result-test-result result-test-result-skipped">
          {% endif %}
          {{ test_results[i]['result'] }}</div>
        </div>
        {% endfor %}
      </div>
      <div class="footer">
        <div class="footer-label">Testrun {{ version }}</div>
        <div class="footer-label" style="right: 0px">Page {{ page_index.value }}/{{ total_pages }}</div>
      </div>
    </div>
    <div style="break-after:page"></div>
  {% endfor %}
  {# Steps to resolve #}
  {% if steps_to_resolve|length > 0 %}
  {% set page_index.value = page_index.value+1 %}
  <div class="page">
    <div class="header" style="margin-bottom:1px solid #DADCE0">
      <h1>Testrun report</h1>
      <h3 style="margin-top:0;max-width:700px"> 
        {{ device['manufacturer'] }}
        {{ device['model']}}
      </h3> 
      <img src="data:image/png;base64, {{ logo }}" alt="Testrun" width="90" style="position: absolute;top: 40%; right: 0px;"></img>
    </div>
    <h1>Steps to Resolve</h1>
    {% for step in steps_to_resolve %}
    <div class="steps-to-resolve">
      <div class="steps-to-resolve-row">
        <span class="steps-to-resolve-index">{{ loop.index }}.</span>
        <div class="steps-to-resolve-test-name">
          <span class="steps-to-resolve subtitle">Name</span><br>{{ step['name'] }}
        </div>
        <div class="steps-to-resolve-description">
          <span class="steps-to-resolve subtitle">Description</span><br>{{ step["description"] }}
        </div>
      </div>
      <div class="steps-to-resolve-row" style="margin-left: 70px;">
        <span class="steps-to-resolve subtitle">Steps to resolve</span>
        {% for recommedtation in step['recommendations'] %}
          <br><span style="font-size: 14px">{{ loop.index }}. {{ recommedtation }}</span>
        {% endfor %}
      </div>
    </div>
    {% endfor %}
  <div class="footer">
    <div class="footer-label">Testrun {{ version }}</div>
    <div class="footer-label" style="right: 0px">Page {{ page_index.value }}/{{ total_pages }}</div>
  </div>
  </div><div style="break-after:page"></div>
  {% endif %}
  {# Modules reports #}
  {% for module in module_reports %}
  {% set page_index.value = page_index.value+1 %}
  <div class="page">
    <div class="header" style="margin-bottom:1px solid #DADCE0">
      <h1>Testrun report</h1>
      <h3 style="margin-top:0;max-width:700px"> 
        {{ device['manufacturer'] }}
        {{ device['model']}}
      </h3> 
      <img src="data:image/png;base64, {{ logo }}" alt="Testrun" width="90" style="position: absolute;top: 40%; right: 0px;"></img>
    </div>
    <div class="module-page-content">
      {{ module }}  
    </div>
  <div class="footer">
    <div class="footer-label">Testrun {{ version }}</div>
    <div class="footer-label" style="right: 0px">Page {{ page_index.value }}/{{ total_pages }}</div>
  </div>
  </div>
  <div style="break-after:page"></div>
  {% endfor %}
</body>
</html>
